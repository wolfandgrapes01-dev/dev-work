pip install pybind11-stubgen


# 生成 stub 文件
add_custom_command(
    TARGET pysharedlib PRE_BUILD
    COMMAND ${CMAKE_COMMAND} -E rm -rf "${OUTPUT_DIR}"
    COMMAND ${CMAKE_COMMAND} -E make_directory "${OUTPUT_DIR}"

    TARGET pyshairedlib POST_BUILD
    COMMAND ${Python_EXECUTABLE} -m pybind11_stubgen $<TARGET_FILE:pysharedlib>
    WORKING_DIRECTORY ${OUTPUT_DIR}
)
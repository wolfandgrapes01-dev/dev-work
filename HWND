// MyWnd.h
#pragma once
#include <afxwin.h>
#include <functional>
#include <pybind11/pybind11.h>

namespace py = pybind11;

#define WM_RESPONSE (WM_USER + 100)

class CMsgDlg : public CDialog  // 或 CDialogEx
{
public:
    CMsgDlg() : CDialog(IDD_MYDIALOG) {}

    // 注册 Python 回调
    void registerCallback(py::function f) {
        pyCallback = [f](int val){
            py::gil_scoped_acquire gil;  // 获取 GIL
            f(val);
        };
    }

protected:
    std::function<void(int)> pyCallback;

    afx_msg LRESULT OnResponse(WPARAM wParam, LPARAM lParam);

    DECLARE_MESSAGE_MAP()
};